databaseChangeLog:
- changeSet:
    id: add-media-user-table-1
    author: dan
    changes:
    - createTable:
        tableName: media_user
        columns:
        - column:
            name: id
            type: UUID
            defaultValueComputed: (gen_random_uuid())
            constraints:
                nullable: false
                unique: true
                primaryKey: true
                primaryKeyName: user_pkey
        - column:
            name: name
            type: TEXT
            constraints:
                nullable: false
        - column:
            name: description
            type: TEXT
        - column:
            name: email
            type: CITEXT
            constraints:
                nullable: false
                unique: true
                uniqueConstraintName: user_email_ukey
        - column:
            name: created_by
            type: UUID
            constraints:
                nullable: false
                references: media_user(id)
                foreignKeyName: user_created_by_fkey
        - column:
            name: created_date
            type: TIMESTAMP WITH TIME ZONE
            defaultValueComputed: (now() at time zone 'utc')
            constraints:
                nullable: false
        - column:
            name: last_modified_by
            type: UUID
            constraints:
                nullable: false
                references: media_user(id)
                foreignKeyName: user_modified_by_fkey
        - column:
            name: last_modified_date
            type: TIMESTAMP WITH TIME ZONE
            defaultValueComputed: (now() at time zone 'utc')
            constraints:
                nullable: false
    - sql:
        sql: CREATE TRIGGER update_media_user_last_modified_date BEFORE UPDATE ON media_user FOR EACH ROW EXECUTE PROCEDURE util.update_last_modified_date();
    - sqlFile:
        path: util/create_new_media_user.sql
        relativeToChangelogFile: true
        splitStatements: false
